// Prisma schema for DITEC Gest√£o de Contratos

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum ModalidadeContrato {
  PREGAO_ELETRONICO
  CONTRATO_CONTINUADO
  INEXIGIBILIDADE
}

enum StatusContrato {
  ATIVO
  EM_ALERTA
  VENCIDO
  ENCERRADO
}

model Contract {
  id                  String          @id @default(uuid())
  numeroContrato      String
  processoLicitatorio String?
  orgaoResponsavel    String
  empresaContratada   String
  cnpjEmpresa         String
  objetoContrato      String
  dataInicio          DateTime
  dataFim             DateTime
  valorGlobal         Decimal         @db.Decimal(14, 2)
  modalidade          ModalidadeContrato
  statusContrato      StatusContrato
  prazoMaximoMeses    Int             @default(60)
  valorEstimado       Decimal?        @db.Decimal(14, 2)
  diferencaPercentual Decimal?        @db.Decimal(6, 2)
  priceSources        PriceSource[]
  createdAt           DateTime        @default(now())
  updatedAt           DateTime        @updatedAt
}

model PriceSource {
  id            String   @id @default(uuid())
  contractId    String
  contract      Contract @relation(fields: [contractId], references: [id], onDelete: Cascade)
  fonte         String
  url           String?
  precoColetado Decimal  @db.Decimal(14, 2)
  dataColeta    DateTime
  createdAt     DateTime @default(now())
}
